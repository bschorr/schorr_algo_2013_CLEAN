Similar code to 03_04, but adapted to the Processing environment.
Processing version has a much poorer performance, though...
